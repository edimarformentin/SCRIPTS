<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VaaS ‚Ä¢ C√¢meras</title>
  <link rel="stylesheet" href="/css/cameras.css" />
</head>
<body>
<div class="container">
  <h1>VaaS ‚Ä¢ C√¢meras</h1>
  <nav class="nav">
    <a href="/index.html">Clientes</a>
    <a href="/cameras.html">C√¢meras</a>
  </nav>

  <section class="panel">
    <h2 style="margin-top:0">Nova C√¢mera</h2>
    <div class="form-grid">
      <div>
        <label>Cliente</label>
        <select id="cliente_id">
          <option value="">Carregando clientes...</option>
        </select>
      </div>
      <div><label>Nome (max 10 caracteres)</label><input id="nome" maxlength="10" placeholder="cam1" /></div>
      <div>
        <label>Protocolo</label>
        <select id="protocolo">
          <option>RTSP</option>
          <option>RTMP</option>
          <option>HLS</option>
        </select>
      </div>
      <div><label>Endpoint</label><input id="endpoint" placeholder="rtsp://... | rtmp://... | http://...m3u8" /></div>
    </div>
    <div style="margin-top:16px; padding:12px; background:#1a1a1a; border-radius:6px; border:1px solid #333;">
      <label style="display:flex; align-items:center; cursor:pointer; gap:8px;">
        <input type="checkbox" id="transcode_to_h265" style="width:20px; height:20px; cursor:pointer;" />
        <span style="flex:1;">
          <strong style="color:#4ade80;">üîÑ Converter para H.265 ao gravar</strong>
          <br/>
          <small style="color:#888;">Economia ~50% de espa√ßo em disco. Requer recursos de CPU/GPU dispon√≠veis.</small>
        </span>
      </label>
      <div id="resource-warning" style="display:none; margin-top:8px; padding:8px; background:#7f1d1d; border-radius:4px; border:1px solid #dc2626;">
        <small id="resource-warning-text" style="color:#fecaca;">‚ö†Ô∏è Recursos insuficientes</small>
      </div>
    </div>
    <div style="margin-top:10px">
      <button id="salvar">Salvar</button>
    </div>

    <div class="tabs" style="margin-top:10px">
      <div class="tab active" data-tab="rtsp">RTSP</div>
      <div class="tab" data-tab="rtmp">RTMP</div>
      <div class="tab" data-tab="hls">HLS</div>
    </div>
  </section>

  <!-- Player √∫nico para ao vivo E grava√ß√µes -->
  <section class="panel">
    <h2 style="margin-top:0" id="player-title">Player</h2>
    <div class="player">
      <video id="player" controls muted playsinline preload="metadata"></video>
      <small class="muted" id="player-hint">Dica: para HLS (.m3u8) no navegador, use HLS.js; j√° habilitamos no JS.</small>
    </div>
    <!-- Timeline (vis√≠vel apenas em modo grava√ß√µes) -->
    <div id="recordings-timeline" style="display:none; margin-top:16px;"></div>
    <!-- Informa√ß√µes (vis√≠vel apenas em modo grava√ß√µes) -->
    <div id="recordings-info" style="display:none; margin-top:16px;"></div>
  </section>

  <section class="panel">
    <h2 style="margin-top:0">C√¢meras</h2>
    <table class="table" id="tbl">
      <thead>
        <tr><th>Nome</th><th>Cliente Nome</th><th>Protocolo</th><th>Endpoint</th><th>Ativo</th><th>A√ß√µes</th></tr>
      </thead>
      <tbody id="tbody"><tr><td colspan="6" class="empty">Carregando...</td></tr></tbody>
    </table>
  </section>
</div>

<div id="toast" class="toast"></div>
<script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
<script defer src="/js/cameras.js?v=1761829927"></script>
</body>
</html>
